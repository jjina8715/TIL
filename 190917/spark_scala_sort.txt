scala> sc.textFile("/edudata/product_click.log").flatMap(_.split(" ")).filter(_.matches("^p[0-9]{3}$")).map((_,1))
.reduceByKey(_+_).map{wordAndCount=>(wordAndCount._2, wordAndCount._1)}.sortByKey(false)
.map{countAndWord=>(countAndWord._2, countAndWord._1)}.collect.foreach(println)
(p001,84)
(p009,80)
(p008,80)
(p007,71)
(p002,66)
(p010,58)
(p003,54)
(p006,51)
(p004,50)
(p011,49)
(p005,43)
(p012,39)
(p014,10)
(p015,7)
(p013,4)
